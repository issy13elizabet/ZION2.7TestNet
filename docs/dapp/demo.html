<!doctype html>
<html lang="cs">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ZION dApp – Amenti Library Demo</title>
    <style>
      :root {
        --bg: #0a0a0a; --fg: #eaeaea; --accent: #E7C34E; --muted: #9aa0a6;
      }
      body { margin: 0; font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji"; background: var(--bg); color: var(--fg); }
      header { padding: 24px; border-bottom: 1px solid #111; display: flex; gap: 16px; align-items: center; }
      header img { width: 40px; height: 40px; }
      main { max-width: 1000px; margin: 24px auto; padding: 0 16px; }
      .toolbar { display: flex; gap: 12px; flex-wrap: wrap; margin-bottom: 16px; }
      input { background: #111; color: var(--fg); border: 1px solid #222; border-radius: 8px; padding: 10px 12px; width: 280px; }
      .card { border: 1px solid #1c1c1c; background: #0f0f0f; border-radius: 12px; padding: 16px; margin: 12px 0; }
      .card h3 { margin: 0 0 8px 0; color: var(--accent); }
      .badges { display: flex; gap: 8px; flex-wrap: wrap; margin: 8px 0; }
      .badge { background: #132; color: #cde; border: 1px solid #234; padding: 2px 8px; border-radius: 999px; font-size: 12px; }
      .actions a { color: #bde; margin-right: 12px; text-decoration: none; }
      footer { opacity: 0.8; margin: 24px 0; font-size: 14px; color: var(--muted); }
    </style>
  </head>
  <body>
    <header>
      <img src="../../assets/logos/zion.svg" alt="ZION logo" />
      <h1>ZION dApp – Amenti Library</h1>
    </header>
    <main>
      <div class="toolbar">
        <input id="q" placeholder="Hledat (název, štítky)" />
      </div>
      <div id="list"></div>
      <footer>
        Data manifest: <code>data/amenti/library.json</code> · Zdroje a knihy patří svým autorům. Tento demo frontend pouze odkazuje na původní stránky/odkazy.
      </footer>
    </main>
    <script>
      const state = { books: [], q: '' };
      const list = document.getElementById('list');
      const q = document.getElementById('q');

      q.addEventListener('input', () => { state.q = q.value.toLowerCase(); render(); });

      function fits(b){
        if(!state.q) return true;
        const hay = [b.title, (b.tags||[]).join(' '), (b.categories||[]).join(' '), (b.description||'')].join(' ').toLowerCase();
        return hay.includes(state.q);
      }

      function render(){
        list.innerHTML = '';
        state.books.filter(fits).forEach(b => {
          const el = document.createElement('div');
          el.className = 'card';
          el.innerHTML = `
            <h3>${b.title}</h3>
            <div class="badges">${(b.categories||[]).map(c=>`<span class="badge">${c}</span>`).join('')}</div>
            <p>${b.description||''}</p>
            <div class="actions">
              ${b.landingPage ? `<a href="${b.landingPage}" target="_blank" rel="noopener">Otevřít</a>` : ''}
              ${(b.downloads||[]).map(d=>`<a href="${d.url}" target="_blank" rel="noopener">Stáhnout${d.type?` (${d.type})`:''}</a>`).join(' ')}
            </div>
          `;
          list.appendChild(el);
        });
      }

      (async function init(){
        const res = await fetch('../../data/amenti/library.json');
        if(!res.ok){ list.textContent = 'Nepodařilo se načíst manifest.'; return; }
        const json = await res.json();
        state.books = json.books || [];
        render();
      })();
    </script>
  </body>
</html>
